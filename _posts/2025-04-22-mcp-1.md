---
layout: post
title: "MCPæ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç”¨"
date: 2025-04-22 10:00:00 +0800
categories: [AI]
tags: [Claude, OpenAi, å¤§æ¨¡å‹, mcp]
---

# ç†è§£ MCPï¼šè®©å¤§æ¨¡å‹çœŸæ­£åŠ¨èµ·æ¥

åœ¨æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å’Œå¤§æ¨¡å‹çš„ç»“åˆè¶Šæ¥è¶Šæ·±å…¥çš„ä»Šå¤©ï¼ŒMCPï¼ˆModel Callable Pluginï¼‰ä½œä¸ºå¤§æ¨¡å‹èƒ½åŠ›æ‹“å±•çš„ä¸€ç§æ–¹å¼ï¼Œæ­£å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚æœ¬æ–‡ç»“åˆæˆ‘çš„å®è·µç»éªŒï¼Œç³»ç»Ÿæ¢³ç† MCPã€Function Call çš„åŸç†ä¸å…³ç³»ï¼Œå¹¶åˆ†æå®ƒä»¬å¦‚ä½•ä¸€èµ·åä½œã€å‘æŒ¥å¨åŠ›ã€‚



## 1. ä»€ä¹ˆæ˜¯ MCPï¼ˆModel Callable Pluginï¼‰

MCPï¼ˆModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰æ˜¯ç”± Anthropic å…¬å¸ï¼ˆä¹Ÿå°±æ˜¯å¼€å‘ Claude æ¨¡å‹çš„å…¬å¸ï¼‰æ¨å‡ºçš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†åè®®ï¼Œå°±åƒæ˜¯ä¸€ä¸ª â€œé€šç”¨æ’å¤´â€ æˆ–è€… â€œUSB æ¥å£â€ï¼Œåˆ¶å®šäº†ç»Ÿä¸€çš„è§„èŒƒï¼Œä¸ç®¡æ˜¯è¿æ¥æ•°æ®åº“ã€ç¬¬ä¸‰æ–¹ APIï¼Œè¿˜æ˜¯æœ¬åœ°æ–‡ä»¶ç­‰å„ç§å¤–éƒ¨èµ„æºï¼Œç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³ AI æ¨¡å‹ä¸å¤–éƒ¨æ•°æ®æºã€å·¥å…·äº¤äº’çš„éš¾é¢˜ã€‚å®ƒé€šå¸¸åŒ…å«ä»¥ä¸‹æ ¸å¿ƒè¦ç´ ï¼š

- **èƒ½åŠ›å°è£…**ï¼šMCP æ˜¯ä¸€ä¸ªå…·å¤‡ç‰¹å®šä¸šåŠ¡é€»è¾‘çš„ API æœåŠ¡ï¼ˆå¦‚æŸ¥è¯¢å¤©æ°”ã€æ“ä½œ GitHubã€è®¿é—®æ•°æ®åº“ï¼‰ã€‚
- **ç»“æ„åŒ–æ¥å£**ï¼šMCP å¿…é¡»æä¾›æ ‡å‡†åŒ–çš„ JSON Schemaï¼Œç”¨äºæè¿°å¦‚ä½•è¢«è°ƒç”¨ï¼ˆå‚æ•°ã€è¿”å›ç»“æ„ï¼‰ã€‚
- **å¯è§£é‡Šæ‰§è¡Œ**ï¼šå¤§æ¨¡å‹é€šè¿‡ Function Call ç†è§£æ¥å£ç»“æ„å¹¶æ„é€ è°ƒç”¨å‚æ•°ï¼Œä»è€Œå‘èµ·è¯·æ±‚ã€‚

MCP = Plugin + æ ‡å‡†æ¥å£ + è¢«å¤§æ¨¡å‹â€œç†è§£å’Œè°ƒç”¨â€çš„èƒ½åŠ›ã€‚


![image](https://github.com/user-attachments/assets/cc2b4c0c-abd6-42db-b8d7-b5efd90d8bd2)


ä½œä¸ºmcpçš„å¼€å‘è€…å’Œä½¿ç”¨è€…ï¼Œå¯ä»¥å¤šåœ¨mcpçš„ç½‘ç«™ä¸Šçœ‹çœ‹åˆ«äººæä¾›äº†ä»€ä¹ˆæ ·çš„å·¥å…·ï¼Œæ€ä¹ˆä½¿ç”¨ç»™è‡ªå·±æ‰¾æ‰¾çµæ„Ÿä¹Ÿå‡å°‘é‡å¤é€ è½®å­çš„å¯èƒ½ã€‚

![image](https://github.com/user-attachments/assets/e8d54527-a822-404b-bb79-c901cb7ecf87)


## 2. ä»€ä¹ˆæ˜¯ Function Callï¼Ÿ

åœ¨æè¿°mcpçš„æ—¶å€™å°±ä¸å¾—ä¸æåˆ°ä¸€ä¸ªæ¦‚å¿µï¼š*function call*

Function Call æ˜¯ä¸€ç§å¤§æ¨¡å‹ï¼ˆå¦‚ OpenAI GPT-4ï¼‰æ”¯æŒçš„æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…å°†å‡½æ•°å®šä¹‰ï¼ˆåŒ…æ‹¬å‡½æ•°åã€å‚æ•° schema å’Œæè¿°ï¼‰ä½œä¸ºä¸Šä¸‹æ–‡ä¼ å…¥ï¼Œå¤§æ¨¡å‹å°†åŸºäºå¯¹ç”¨æˆ·æ„å›¾çš„ç†è§£ä¸»åŠ¨æ„é€ å‡½æ•°è°ƒç”¨ã€‚

Function Call æ”¯æŒçš„è¿‡ç¨‹åŒ…æ‹¬ï¼š

- å‡½æ•°æ³¨å†Œï¼ˆæä¾› JSON schemaï¼‰
- ç”¨æˆ·å‘èµ·è‡ªç„¶è¯­è¨€è¯·æ±‚
- æ¨¡å‹åˆ¤æ–­æ˜¯å¦è§¦å‘å‡½æ•°
- è‡ªåŠ¨å¡«å‚å¹¶è¿”å›è°ƒç”¨ç»“æ„ï¼ˆå¦‚ï¼š`{"name": "get_weather", "arguments": { "city": "Beijing" }}`ï¼‰

![image](https://github.com/user-attachments/assets/12705a6a-2ed5-47ce-bc25-8f2cbe4f33f0)


æ³¨ï¼š funcationcall ä¸æ˜¯æ¯ä¸ªæ¨¡å‹éƒ½æ”¯æŒï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„åˆ†è¾¨


## 3. MCP ä¸ Function Call çš„å…³ç³»

å¯¹ç…§å¦‚è¡¨æ‰€ç¤ºï¼š
| å¯¹æ¯”ç‚¹    | MCP                | Function Call                     |
|-----------|--------------------|-----------------------------------|
| å®šä¹‰è€…    | å¼€å‘è€…ï¼ˆå†™æ¥å£ï¼‰   | LLM å¹³å°ï¼ˆå¦‚ OpenAIï¼‰             |
| æ‰§è¡Œè§’è‰²  | åç«¯æœåŠ¡/æ’ä»¶      | å¤§æ¨¡å‹ï¼ˆåˆ¤æ–­å¹¶å¡«å‚ï¼‰              |
| è§¦å‘æ–¹å¼  | è¢«è°ƒç”¨             | ä¸»åŠ¨è°ƒç”¨                          |
| å†…å®¹æè¿°  | æä¾›æ¥å£ schema    | æ¥æ”¶å¹¶ä½¿ç”¨ schema                 |
| æ ¸å¿ƒä»·å€¼  | å°è£…å¤–éƒ¨åŠŸèƒ½       | è‡ªç„¶è¯­è¨€æ˜ å°„ä¸ºç»“æ„åŒ–è°ƒç”¨          |


âœ… **MCP æ˜¯æ‰§è¡Œå•å…ƒï¼ŒFunction Call æ˜¯è§¦å‘æœºåˆ¶**ã€‚  
åœ¨ä¸€ä¸ªä½œè€…è®¤ä¸ºæ¯”è¾ƒå‹å¥½çš„ç³»ç»Ÿé‡Œé¢ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œæ—¢æœ‰function callçš„ä¼˜é›…ï¼Œåˆå…·å¤‡äº†MCPçš„çµæ´»å’Œå¯æ’æ‹”ï¼š

> ç”¨æˆ·è¯·æ±‚ â†’ å¤§æ¨¡å‹åˆ¤æ–­ â†’ å‘èµ· Function Call â†’ è°ƒç”¨ MCP â†’ è¿”å›ç»“æœ â†’ å†ç”±æ¨¡å‹å›å¤ç”¨æˆ·


## 4. MCP åŸç†è§£æï¼šæç¤ºè¯ vs Function Call

### â˜ï¸ ä¼ ç»Ÿæç¤ºè¯å®ç°

æ—©æœŸå®ç° MCP çš„æ–¹å¼æ˜¯é€šè¿‡æç¤ºè¯å¼•å¯¼æ¨¡å‹è¾“å‡ºç‰¹å®šæ ¼å¼ï¼Œç„¶ååœ¨åç«¯è§£æç»“æ„ã€æ‰§è¡ŒåŠŸèƒ½ã€‚

ç¤ºä¾‹ Promptï¼š

```text
ä½ æ˜¯ä¸€ä¸ªå¤©æ°”åŠ©æ‰‹ï¼Œå½“ç”¨æˆ·é—®å¤©æ°”æ—¶ï¼Œè¯·è¾“å‡ºå¦‚ä¸‹æ ¼å¼ï¼š
{"city": "åŒ—äº¬", "date": "æ˜å¤©"}
```
è™½ç„¶è¿™ç§æ–¹å¼å¯è¡Œï¼Œä½†ä»å­˜åœ¨ä¸€äº›ä¸å¯å¿½è§†çš„é—®é¢˜ï¼š
> â€¢	å®¹æ˜“ hallucinationï¼ˆæ¨¡å‹èƒ¡ç¼–ï¼‰
> 
> â€¢	æ ¼å¼æ§åˆ¶å¼±
> 
> â€¢	ä¸é€‚åˆå¤§è§„æ¨¡åœºæ™¯æ‰©å±•
> 

æç¤ºè¯å¸¦æ¥çš„é—®é¢˜é™¤äº†ä¸å¤Ÿä¼˜é›…ï¼Œå¯èƒ½ä¼šæ˜¯ä¸€ä¸ªæç¤ºè¯çš„ç¼–å†™ç¾éš¾ï¼Œåºå¤§çš„æç¤ºè¯å·¥ç¨‹è®©åç»­çš„ç»´æŠ¤å˜çš„å›°éš¾ï¼ŒåŒæ—¶æ¶ˆè€—å¤§é‡tokenã€‚

### âš™ï¸ Function Call å®ç°


ç°åœ¨ï¼Œé€šè¿‡ Function Callï¼Œæ¨¡å‹å¯ä»¥å¯é åœ°äº§ç”Ÿç»“æ„åŒ–è¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨å†³å®š æ˜¯å¦ è°ƒç”¨ã€è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œä»¥åŠå¦‚ä½•æ„é€ å‚æ•°ã€‚

å®ç°æ­¥éª¤ï¼š
> 	1.	å®šä¹‰å‡½æ•° schemaï¼Œæ³¨å†Œç»™æ¨¡å‹
> 	2.	æ¥æ”¶ç”¨æˆ·è‡ªç„¶è¯­è¨€è¯·æ±‚
> 	3.	æ¨¡å‹è¾“å‡ºç»“æ„åŒ–è°ƒç”¨ç»“æ„
> 	4.	åç«¯è°ƒç”¨ MCP æœåŠ¡ï¼ˆçœŸå® APIï¼‰
> 	5.	æ¨¡å‹å°†è¿”å›å€¼ç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”

```json
{
  "name": "get_weather",
  "description": "æŸ¥è¯¢å¤©æ°”",
  "parameters": {
    "type": "object",
    "properties": {
      "city": { "type": "string", "description": "åŸå¸‚åç§°" },
      "date": { "type": "string", "description": "æ—¥æœŸ" }
    },
    "required": ["city"]
  }
}
```
ä¸ªäººæ¨èçš„æ–¹å¼ï¼ˆå‰ææ‚¨é€‰çš„æ¨¡å‹æ˜¯æ”¯æŒfunctioncallçš„ï¼‰ï¼Œä¼˜é›…çš„å®ç°ã€‚


### è°ƒç”¨é“¾
ä¸ç®¡æ˜¯ä»€ä¹ˆæ–¹å¼çš„è°ƒç”¨ï¼Œæ€»ä½“çš„è°ƒç”¨æ–¹å¼åŸºæœ¬ç»´æŒä¸€è‡´ã€‚

**åœ¨è¿™ä¸ªé‡Œé¢æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„äº‹æƒ…ï¼Œå¤šæ•°æƒ…å†µä¸‹å¤§æ¨¡å‹ä½œä¸ºä¸€ä¸ªæ€»ç»“å’Œæ„å›¾è¯†åˆ«çš„é‡è¦çš„èŠ‚ç‚¹ä¾æ—§ä¿æŒï¼Œæ‰€ä»¥å¼€å‘ä¸€ä¸ªmcpçœŸçš„ä¸‡äº‹å¤§å‰çš„æ€æƒ³éœ€è¦æ‘’å¼ƒï¼Œåœ¨å†³å®šæ˜¯å¦é€šè¿‡MCPå®ç°æŸåŠŸèƒ½æ—¶ï¼Œæ‰”éœ€è¦æƒè¡¡åœºæ™¯å¤æ‚æ€§å’Œæ”¶ç›Š**

![image](https://github.com/user-attachments/assets/c1264228-2e3f-4fca-a712-0b67aff09d95)


## 5. MCP åº”ç”¨åœºæ™¯ä¸å½“å‰å®è·µ

MCP æ­£åœ¨å¤šä¸ªé¢†åŸŸè½åœ°ä½¿ç”¨ï¼š

| åœºæ™¯ | ç¤ºä¾‹ | 
|--------|-----|
| å¼€å‘è€…åŠ©æ‰‹ | Github MCP:æŸ¥è¯¢PR,åˆ—å‡ºä»“åº“ | 
| çŸ¥è¯†å¢å¼º | é€šè¿‡æ’ä»¶è®¿é—®ä¼ä¸šçŸ¥è¯†åº“ | 
| IoT & ç³»ç»Ÿæ§åˆ¶ | æ§åˆ¶æ™ºèƒ½ç¡¬ä»¶ã€å‡ºå‘å¤–éƒ¨ç³»ç»Ÿä»»åŠ¡ | 
| ä¼ä¸šé›†æˆ | ERPã€OAç­‰ç³»ç»Ÿå°è£…ä¸ºMCP| 
| æ•°æ®åˆ†æ | é€šè¿‡MCPæ¥å£è°ƒç”¨åˆ†æå¼•æ“ï¼ˆå¦‚SQL) | 

ğŸ”§ å½“å‰å®è·µå·¥å…·ï¼š
> 	â€¢	OpenAI Plugin / Function Call
> 
> 	â€¢	LangChain Tool / Agent / Runnable
> 
> 	â€¢	Dify æ’ä»¶ç³»ç»Ÿ
> 
> 	â€¢	Clerkã€Cursor æ’ä»¶
> 
> 	â€¢	è‡ªå»ºæ’ä»¶å¹³å° + LLM æ¥å£å°è£…

## 6. MCPçš„åˆä½“éªŒ

VS CODE + CLINE æ˜¯ä¸€ä¸ªå¯¹å¾ˆå¼€å‘è€…æˆ–è€…æœ‰å¼€å‘ç»éªŒçš„äººçš„ä¸€ä¸ªä¸Šæ‰‹ä½“éªŒçš„ç†æƒ³èµ·ç‚¹ï¼Œé€šè¿‡åœ¨vs code ä¸Šå®‰è£…clineçš„æ’ä»¶çš„æ–¹å¼æ¥ä½“éªŒä¸€ä¸ªMCPæ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼ˆæ³¨ï¼šCLINEæ˜¯tokenæ¶ˆè€—å¤§æˆ·ï¼‰

![image](https://github.com/user-attachments/assets/73837da6-fe11-406b-a25b-3d20f6813878)


åœ¨vs codeçš„æ’ä»¶ä¸­æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶è¿›è¡Œå®‰è£…ï¼Œæ­¤å¤„ä¸ä½œè¿‡å¤šçš„é…ç½®è¯´æ˜ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨ç½‘ä¸Šæ‰¾åˆ°ã€‚

![image](https://github.com/user-attachments/assets/80531b68-0e9e-4e58-b5a7-57d4ecbcc343)


## å¼€å‘ MCP è¦æ³¨æ„çš„å‘

- âŒ å¿½ç•¥ JSON Schema çš„æè¿°ï¼Œå¯¼è‡´æ¨¡å‹å¡«å‚å¤±è´¥
- âŒ è®© MCP å˜æˆäº†åç«¯â€œèƒ¶æ°´â€ï¼Œæ²¡æœ‰è®¾è®¡å‡ºæ¸…æ™°åŠŸèƒ½è¾¹ç•Œ
- âŒ æŠŠæ¨¡å‹å½“ä½œåŒæ­¥ API è°ƒç”¨å¼•æ“ï¼Œå¿½è§†æ¨¡å‹çš„å¤šè½®äº¤äº’èƒ½åŠ›
  
## ğŸ“š å»¶ä¼¸é˜…è¯»

- Anthropic å®˜æ–¹ MCP åè®®æ–‡æ¡£ï¼š[https://docs.anthropic.com/](https://docs.anthropic.com/)
- OpenAI Function Call ç¤ºä¾‹é¡¹ç›®ï¼š[https://platform.openai.com/docs/guides/function-calling](https://platform.openai.com/docs/guides/function-calling)
- LangChain Tool æ³¨å†Œæ–¹æ³•ï¼š[https://docs.langchain.com/docs/components/tools](https://docs.langchain.com/docs/components/tools)
